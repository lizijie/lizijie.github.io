---
layout: post
title: 杂谈
key: 201910211243
tags: 杂谈
---

2020-5-6
---
技术积累要回归起点。举两个曾经的疑问，1.常用内存字节长度有1、2、4和8，为什么跳过3、5、6和7？2. 为什有引用类型的语言不能/不建议操作地址？被外行问过，1.写完代不是就能运行了吗，为什么还要编译？

这些都是小问题大学问。激发/思考/回归这类问题，当然自己可以去翻书，但更高的回归效率应该是回答外行/新手“来自最原始的疑问”。还有就是行内多技术交流。

如果是想研究技术，就不要厌烦外行/新手的问题，不要担心因为回答不上问题而感到羞耻/或暴露了不能外见的私密似的/或爱面子怕被怼。

我一向认为技术交流，就像学术辩论一样，讨论的话题只有技术，末了的积极态度是赞赏和倾慕！


2020-2-18
---
Lua是用C实现的，可以说它先天就拥有操作系统级别的性能优势（当然最终要看Lua的实现效率），我甚至怀疑这种性能优势是Lua被广泛用于游戏开发的一个重要原因。Lua是我目前使用过最易用的编程语言，可能是考虑跨平台运行（ANSI C）的原因，它内置没有高级API，比如没有多线程、Socket api等。我特别喜欢Lua的安全模式(或称沙盒模式，pcall和xpcall)，有别于大多语言的异常捕捉，pcall(xpcall)通过返回错误码和定义错误处理函数的做法，令代码更加优雅。

Lua的简单易用，也必定让它走向另一个极端。变量赋值不需要类型一致（赋值只是让变量指向另一个lua对象），所以除非有清晰的定义规范和充分的注释，否则阅读代码时层层追溯一个lua对象的定义简直就是恶梦。跨平台的原因，Lua精简内置的功能，提供的接口很少，所以很多问题需要开发者自己解决，比如不要惊讶你的项目居然还要为lua封装一系列字符串操作接口。Lua用8字节来统一表示整数和浮点，你无法像其它编程语那样，为了精打细算内存去定义一个2字节整形或者4字节浮点数。一个“不适当”的赋值，Lua在你毫不知情下，暗暗地将table从线性转成哈希结构（或者哈希转线性结结构），这一方面无法确切地掌控内存，令程序容易踩入性能问题。



2019-12-10
---
C/C++不应该有垃圾回收。只要C/C++还是操作系统的主要实现语言，C/C++就不会有内置垃圾回收机制。这是近日看了[《垃圾回收的算法与实现》](https://book.douban.com/subject/26821357/)前几章后有感。书中没谈该到观点。只是明白了书中要表达到的意思后，回想起常有人抱怨C/C++没有垃圾回收，固有此想。

看了前面几章，主要介绍了几个GC算法：位图标记，复制gc，引用计数和分代gc。尽管这么多算法，但每种算法都解决同一个问题，对象什么时候被释放才是效率最大。因为频繁使用的对象就算没被引用，在空间和性能允许的条件下也应该被继续保留，而不是立即清除。保留多久的问题上就是各个GC实现细节差异。引用计数认为当计数小于等于0时就要释放对象，而分代认为最后创建的对象会被优先考虑GC。而算法在性能和空间的微小取舍上派生子版本。如标记GC算法，扩展出了复制标记和压缩标记算法。

各个垃圾回收算法各有特点，不存在一个通吃所有情况的GC算法。 C/C++的一大特性是“靠近”操作系统，为了更好性能，操作系统的核心部分是用C/C++和汇编语言写的，这里不是业务层，无法知首具体要处理的问题，如果是C/C++语言的设计者，使用哪个作为内置GC算法？答案是不解决这个问题。由业务层框架解决垃圾回收算法问题，根据使用场景特性选择适当的回收方案。

恐怕C/C++的完美之一是没有垃圾回收！


2019-12-8
---
个人认为单例模式是经常被玩坏了的设计模式。常看到业务框架中出现一大坨单例，究竟是需要单例还是用全局对象呢？频繁地敲打字符“GetInstance()”令我感到厌倦。回顾一下单例模式的需求特性：1. 类型不能实例化多次，否则内部会产生逻辑冲突。2.业务范围内不能获取到实例。然而我所遇到过大多数的单例都不满足条件1，可以很轻松实例化多次。而条件2是大家都喜欢使用它的原因，全局访问特性，能快速将功能“拼凑起来”。但它代价是放弃了进一步思考框架的解耦和内聚性。大多数情况下，我个人偏向用全局对象来替代单例，如果app是程序入口的全局对象，app.audio则是声音控制的管理对象。




2019-10-21
---
开源代码的功能要简洁。或者说刚好满足需求就好。功能越丰富，框架设计会考虑更多、更复杂、代码量更大。当增删改代码时，最终额外增加与需求不相关的人力成本。

---



<br>	
<br>	
<b>原文:<br>
<https://lizijie.github.io/2019/10/21/%E6%9D%82%E8%B0%88.html>
<br>
作者github:<br>	
<https://github.com/lizijie>	
</b>
